"use strict";function callMap(){vm.startMap()}var locations=[{name:"Empire State Building",lat:40.7484444,log:-73.9878441,info:"The Empire State Building is a 102-storty skyscraper located in Midtown Manhattan, New York City, on Fifth Avenue between West 33rd and 34th Streets."},{name:"Statue of Liberty",lat:40.6892534,log:-74.0466891,info:"The Statue of Liberty is a colossal neoclassical sculpture on Liberty Island in New York Harbor in New York City, in the United States."},{name:"Times Square",lat:40.758899,log:-73.9873197,info:"Times Square is a major commercial intersection and neighborhood in Midtown Manhattan, New York City, at the junction of Broadway and Seventh Avenue, and stretching from West 42nd to West 47th Streets."},{name:"Botanical Gardens",lat:40.866559,log:-73.8852977,info:"A botanical garden or botanic garden is a garden dedicated to the collection, cultivation and display of a wide range of plants labelled with their botanical names."},{name:"Ellis Island Immigration Museum",lat:40.6977041,log:-74.0391417,info:"Ellis Island, in Upper New York Bay, was the gateway for over 12 million immigrants to the United States as the nation's busiest immigrant inspection station from 1892 until 1954."},{name:"Yankee Stadium",lat:40.8279884,log:-73.9278355,info:"Yankee Stadium is a stadium located in the Bronx, a borough of New York City. It serves as the home ballpark for the New York Yankees of Major League Baseball (MLB), and the home stadium of New York City FC of Major League Soccer (MLS)."},{name:"Bronx Zoo",lat:40.8505989,log:-73.8791869,info:"The Bronx Zoo is a zoo located in the Bronx, a borough of New York City, within Bronx Park. It is the largest metropolitan zoo in the United States and among the largest in the world."},{name:"Grand Central Terminal",lat:40.7527302,log:-73.9794181,info:"Grand Central Terminal is a commuter, rapid transit railroad terminal at 42nd Street and Park Avenue in Midtown Manhattan in New York City, United States."},{name:"Central Park",lat:40.7828687,log:-73.9675438,info:"Central Park is an urban park in middle-upper Manhattan, within New York City. Central Park is the most visited urban park in the United States, with 40 million visitors in 2013. It is also one of the most filmed locations in the world."},{name:"Brooklyn Museum",lat:40.6712102,log:-73.9658193,info:"The Brooklyn Museum is an art museum located in the New York City borough of Brooklyn. At 560,000 square feet (52,000 m2), the museum is New York City's third largest in physical size and holds an art collection with roughly 1.5 million works"}],Place=function(e){this.name=ko.observable(e.name),this.lat=ko.observable(e.lat),this.log=ko.observable(e.log),this.info=ko.observable(e.info),this.visibleBool=ko.observable(!0),this.infoVisible=ko.observable(!1)},ViewModel=function(){function e(){for(var e=h.length,t=0;e>t;t++)m(h[t]),r(h[t]),d.locationList()[t].infoVisible(!1)}function t(e){d.images.removeAll();var t="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+p+"&lat="+e.lat+"&lon="+e.log+"&format=json&nojsoncallback=1&content_type=1&per_page=12&page=1&radius=1&radius_units=mi";$.getJSON(t,function(e){d.images.removeAll(),$.each(e.photos.photo,function(e,t){var a=t.farm,i=t.server,n=t.id,s=t.secret,l=o(a,i,n,s);d.images.push({url:l})})}).done(function(){void 0===d.images()[0].url&&(d.errMessage("Flickr pictures failed to load :-("),d.images.removeAll())}).fail(function(){d.errMessage("Flickr pictures failed to load :-("),d.images.removeAll()})}function o(e,t,o,a){if(void 0!==e&&void 0!==t&&void 0!==o&&void 0!==a){var i="https://farm"+e+".staticflickr.com/"+t+"/"+o+"_"+a+"_q.jpg'";return i}}function a(){var e=new google.maps.StyledMapType([{stylers:[{hue:"#f0ece6"},{visibility:"simplified"},{gamma:.8},{weight:.5}]},{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#729af1"}]}],{name:"Custom Style"}),t="custom_style",o="img/pin.png";g=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7784051,lng:-73.9464522},zoom:12,disableDefaultUI:!0,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,t]}}),g.mapTypes.set(t,e),g.setMapTypeId(t);for(var a=0;f>a;a++){var l={lat:locations[a].lat,lng:locations[a].log},r=c(a),m=new google.maps.InfoWindow({content:r,maxWidth:200}),d=new google.maps.Marker({position:l,map:g,title:locations[a].name,animation:google.maps.Animation.DROP,icon:o});i(d,g,m,locations[a]),n(d,g,m),s(d),h.push(d)}}function i(o,a,i,n){o.addListener("click",function(){d.closeListEvent(),e(),t(n),i.open(a,o),o.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(null)},700)})}function n(e,t,o){e.addListener("close",function(){o.close(),e.setAnimation(null)})}function s(e){e.addListener("stopAnimation",function(){e.setAnimation(null)})}function l(e){google.maps.event.trigger(e,"click")}function r(e){google.maps.event.trigger(e,"close")}function m(e){google.maps.event.trigger(e,"stopAnimation")}function c(e){var t='<div id="contentString"></div><p>'+locations[e].info+"</p></div>";return t}var d=this,f=locations.length;d.locationList=ko.observableArray([]);for(var u=0;f>u;u++)d.locationList.push(new Place(locations[u]));d.showInfo=function(t){var o=d.getLocationListObject(t());e(),l(h[o]),d.locationList()[o].infoVisible(!0)},d.getLocationListObject=function(e){for(var t=0;f>t;t++)if(d.locationList()[t].name()===e)return t},d.filter=function(){var e=d.input().length,t=d.input().toLowerCase().substring(0,e);d.images.removeAll();for(var o=0;f>o;o++){var a=d.locationList()[o].name().toLowerCase();a.indexOf(t)>-1?(h[o].setVisible(!0),d.locationList()[o].visibleBool(!0)):(h[o].setVisible(!1),d.locationList()[o].visibleBool(!1),r(h[o]))}},d.input=ko.observable(""),d.errMessage=ko.observable(""),d.images=ko.observableArray([]);var g,p="f0b0865d687bdae8485ab41a107f73e4",h=[];d.startMap=function(){a()};var v=document.getElementById("list"),b=document.getElementById("closeList"),y=document.getElementById("apis");b.addEventListener("click",function(){"translateX(100%)"===v.style.transform?(v.style="transform:translateX(0%)",b.style="transform:translateX(0%)",y.style="transform:translateX(0%)",$("#closeList").text("X")):(v.style="transform:translateX(100%)",b.style="transform:translateX(1415%)",y.style="transform:translateX(450%)",$("#closeList").text("<"))}),d.closeListEvent=function(){"translateX(100%)"!==v.style.transform&&$("#closeList").trigger("click")}},vm=new ViewModel;ko.applyBindings(vm);
